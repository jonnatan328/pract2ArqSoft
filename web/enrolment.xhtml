<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>#{msg.title_enrolment}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <link href="css/style.css" rel="stylesheet" type="text/css" />
    </h:head>

    <h:body>  
        <header>
            <h:form class="languages" >
                <h:commandButton action="#{languageBean.changeLanguage('')}" value="English" image="img/eeuu.png" />
                <h:commandButton action="#{languageBean.changeLanguage('es')}" value="EspaÃ±ol" image="img/Spain.png" />
            </h:form>
        </header>

        <div class="content" >
            <div class="form-content">
                <h:form>
                    <h1>
                        <h:outputText value="#{msg.enrolment_details}" />
                    </h1>
                    <h:panelGrid columns="2" class="innerPanel">

                        <h:panelGrid columns="2">
                            <p:outputLabel value="#{msg.student}" for="student" />
                            <p:inputText style="width: 100%" id="student" class="form-input" value="#{student.name} #{student.lastName}" disabled="true"></p:inputText >

                            <p:outputLabel value="#{msg.identification}" for="id"/>    
                            <p:inputText id="id" class="form-input" value="#{student.id}" disabled="true" ></p:inputText >

                            <p:outputLabel value="#{msg.program}" for="program"/>
                            <p:inputText id="program" class="form-input" value="#{student.program}" disabled="true"></p:inputText >

                            <p:outputLabel value="#{msg.date}" for="date"/>
                            <p:inputText id="date" class="form-input" value="#{enrolment.startingDate}" disabled="true"></p:inputText >
                        </h:panelGrid>
                    </h:panelGrid>  
                    <h:panelGrid id="courseTable" class="innerPanel" columns="1"  >
                        <p:dataTable var="course" value="#{enrolment.courses}">
                            <p:column headerText="#{msg.courses}">
                                <h:outputText value="#{course}" />
                            </p:column>      
                        </p:dataTable>   
                        <p:message for="myButton" styleClass="errormsg"/>
                    </h:panelGrid>

                    <h:panelGrid class="innerPanel" columns="3"  >

                        <p:commandButton value="#{msg.add_courses}" oncomplete="PF('diag1').show()" 
                                         update="grid1"/> 

                        <p:commandButton value="#{msg.back}" action="backToStudent"/>

                        <p:commandButton value="#{msg.confirm}" oncomplete="PF('diag2').show()" 
                                         disabled="#{enrolment.disable}" icon='ui-icon-check'
                                         update="qr-validation"/>
                    </h:panelGrid>                
                    <p:dialog header="#{msg.courses}" modal="true" showEffect="clip" widgetVar="diag1">
                        <p:selectManyCheckbox id="grid1" value="#{enrolment.courses}" layout="grid" columns="1">
                            <f:selectItems value="#{enrolment.availableCourses}" var="#{course}" 
                                           itemLabel="#{course}" itemValue="#{course}"/>
                        </p:selectManyCheckbox>

                        <p:commandButton id="myButton" binding="#{enrolment.myButton}"
                                         actionListener="#{enrolment.validate()}"
                                         value="#{msg.add}" oncomplete="PF('diag1').hide()" 
                                         icon='ui-icon-check' update="@form" /> 
                    </p:dialog> 
                </h:form>

                <p:dialog modal="true" showEffect="clip"  widgetVar="diag2" resizable="false" width="20%">
                    <h:form id="qr-validation">
                        <h:panelGrid columns="1">
                            <p:barcode class="qrCode" value="#{QRCode.qrCodeString}" type="qr"/>
                            <p:outputLabel value="#{msg.qr_message}"/>
                            <p:inputText validator="#{QRCode.makeValidation}"/>
                            <p:commandButton actionListener="#{enrolment.save()}" action="submitEnrolment" value="#{msg.confirm}" update="qr-validation"/>
                        </h:panelGrid>
                        <p:messages/>
                    </h:form>
                </p:dialog>
            </div>
        </div>
    </h:body>
</html>
